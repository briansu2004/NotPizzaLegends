@using NotPizzaLegends.Sprites.Maps
@using NotPizzaLegends.Sprites.Characters

<canvas @ref="_canvas" id="game-canvas" width="352" height="198"></canvas>

<DemoLower X="0" Y="0" @ref="_map" />
<Hero X="0.5" Y="3" @ref="_hero" />

@code {
    private ElementReference _canvas;

    private Hero? _hero;
    private DemoLower? _map;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender)
            return;
            
        await DrawMap();
        await DrawHero();
    }
    
    public async Task DrawHero()
    {
        _hero = _hero ?? throw new InvalidOperationException();
        await _hero.Draw(_canvas);
    }

    public async Task DrawMap()
    {
        _map = _map ?? throw new InvalidOperationException();
        await _map.Draw(_canvas);
    }

}